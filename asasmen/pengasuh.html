<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Asasmen Spiritual Pengasuh</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-b from-emerald-700 to-teal-500 min-h-screen font-sans text-gray-800">

  <!-- HEADER -->
  <header class="bg-white/20 backdrop-blur-md text-center text-white py-4 shadow">
    <h1 class="text-2xl font-bold">ğŸ•Šï¸ Asasmen Spiritual Pengasuh</h1>
    <p class="text-sm opacity-90">Refleksi Naik Level Kesadaran Spiritual</p>
  </header>

  <!-- FORM INPUT NAMA -->
  <main class="max-w-3xl mx-auto mt-8 bg-white p-8 rounded-2xl shadow-lg">
    <div id="intro-container" class="text-center">
      <h2 class="text-xl font-bold text-emerald-700 mb-4">Identitas Pengasuh</h2>
      <input id="nama" type="text" placeholder="Masukkan nama lengkap Anda" class="w-full border px-4 py-2 rounded-lg mb-6">
      <button id="start-btn" class="bg-emerald-600 text-white px-6 py-2 rounded-lg hover:bg-emerald-700 font-semibold">Mulai Asasmen</button>
    </div>

    <!-- ASESMEN -->
    <div id="question-container" class="hidden text-center">
      <p id="question-text" class="text-lg font-medium mb-6"></p>
      <div class="grid grid-cols-2 gap-4">
        <button class="answer-btn bg-gray-200 hover:bg-emerald-500 hover:text-white rounded-xl py-3 font-semibold" data-score="10">Tidak Pernah</button>
        <button class="answer-btn bg-gray-200 hover:bg-emerald-500 hover:text-white rounded-xl py-3 font-semibold" data-score="20">Kadang</button>
        <button class="answer-btn bg-gray-200 hover:bg-emerald-500 hover:text-white rounded-xl py-3 font-semibold" data-score="40">Sering</button>
        <button class="answer-btn bg-gray-200 hover:bg-emerald-500 hover:text-white rounded-xl py-3 font-semibold" data-score="80">Selalu</button>
      </div>
      <div class="mt-6 text-sm text-gray-500" id="progress-text"></div>
    </div>

    <!-- HASIL -->
    <div id="result-container" class="hidden text-center">
      <h2 class="text-2xl font-bold text-blue-700 mb-4">ğŸ“Š Hasil Asasmen</h2>
      <p class="text-gray-700 mb-6">Tiga Level Spiritual yang paling dominan:</p>
      <div id="top-levels" class="space-y-2 text-lg font-semibold"></div>
      <button id="restart-btn" class="mt-8 bg-emerald-600 text-white px-6 py-2 rounded-lg hover:bg-emerald-700">ğŸ” Ulangi Asasmen</button>
    </div>
  </main>

  <!-- FIREBASE SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDuxvufRwadUsGh8-Kakl9KTG5ZGVcIoYQ",
      authDomain: "naik-level-81580.firebaseapp.com",
      projectId: "naik-level-81580",
      storageBucket: "naik-level-81580.firebasestorage.app",
      messagingSenderId: "319872430378",
      appId: "1:319872430378:web:64db1b51b159d27d622e53",
      measurementId: "G-RG7JS79MZ1"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ===== DATA PERTANYAAN =====
    const levels = [
      "MALU (Shame)", "RASA BERSALAH (Guilt)", "APATI (Apathy)", "BERDUKA (Grief)", "TAKUT (Fear)",
      "KEINGINAN (Desire)", "MARAH (Anger)", "BANGGA (Pride)", "KEBERANIAN (Courage)", "NETRALITAS (Neutrality)",
      "KEMAUAN (Willingness)", "PENERIMAAN (Acceptance)", "AKAL BUDI (Reason)", "CINTA (Love)",
      "SUKACITA (Joy)", "DAMAI (Peace)", "PENCERAHAN (Enlightenment)"
    ];

    // per level 4 pertanyaan
    const statements = [
      // Level 1
      "Saya merasa tidak layak membimbing orang lain karena merasa diri penuh kekurangan.",
      "Saya memilih menarik diri dari peran kepengasuhan karena takut dinilai atau disalahpahami.",
      "Saya merasa Allah mungkin sudah tidak ridha atas pengabdian saya di pesantren.",
      "Saya merasa kehadiran saya justru membebani orang lain, bukan membawa manfaat.",
      // Level 2
      "Saya sering teringat kesalahan masa lalu dan merasa belum pantas diampuni.",
      "Saya menolak ketenangan batin karena merasa belum menebus dosa atau kelalaian saya sebagai pengasuh.",
      "Saya berbuat baik dengan keras terhadap diri sendiri, bukan karena cinta, tapi karena ingin menebus kesalahan.",
      "Saya sulit memaafkan diri sendiri meski saya yakin Allah Maha Pengampun.",
      // Level 3
      "Saya menjalankan peran pengasuhan secara mekanis, tanpa semangat dan tanpa makna.",
      "Saya merasa perubahan di pesantren percuma, seolah tidak ada yang bisa diperbaiki.",
      "Saya kehilangan arah dan makna dari pengabdian saya.",
      "Saya merasa mati rasa terhadap santri dan rekan kerja, seolah semua tidak lagi berarti.",
      // Level 4
      "Saya sering mengenang masa lalu saat suasana pesantren terasa lebih baik.",
      "Saya merasa kesedihan atas perubahan di pesantren sulit saya lepaskan.",
      "Saya merasa kehilangan semangat lama dan sulit menemukan kembali gairah membina santri.",
      "Saya sering menyesali keputusan atau sikap saya di masa lalu.",
      // Level 5
      "Saya menjalankan peran dengan cemas â€” takut salah, takut dikritik, atau takut mengecewakan pimpinan.",
      "Saya menghindari menegur atau mengambil keputusan karena takut menimbulkan konflik.",
      "Saya banyak memikirkan hal-hal buruk yang mungkin terjadi pada diri atau pesantren.",
      "Saya menjaga jarak dengan santri atau guru karena takut terluka secara emosional.",
      // Level 6
      "Saya merasa gelisah bila program atau gagasan saya tidak dihargai.",
      "Saya membandingkan diri dengan pengasuh lain dan merasa iri dengan pencapaian mereka.",
      "Saya merasa terus mengejar sesuatu tapi tidak pernah benar-benar puas.",
      "Saya merasa semangat saya muncul hanya bila ada pujian, penghargaan, atau perhatian dari orang lain.",
      // Level 7
      "Saya mudah tersinggung terhadap ucapan, perilaku, atau keputusan orang lain di pesantren.",
      "Suasana di sekitar saya sering menjadi tegang karena sikap saya yang keras atau reaktif.",
      "Saya menyimpan kekecewaan pada orang yang tidak sejalan dengan saya.",
      "Saya sering menyalahkan keadaan atau orang lain atas hasil yang tidak sesuai harapan.",
      // Level 8
      "Saya sulit menerima masukan dari pengurus atau rekan sejawat yang lebih muda.",
      "Saya berusaha terlihat kuat dan sempurna agar tidak kehilangan wibawa.",
      "Saya menilai orang lain dari penampilan dan hasil lahiriah lebih dari niat dan perjuangannya.",
      "Saya cenderung mencari pembenaran diri saat salah, agar tetap terlihat benar di hadapan orang lain.",
      // Level 9
      "Saya berani mengakui kesalahan di hadapan santri atau rekan kerja tanpa takut kehilangan wibawa.",
      "Saya memandang setiap masalah di pesantren sebagai tantangan yang bisa memperkuat tim.",
      "Saya mengambil langkah inisiatif untuk memperbaiki keadaan tanpa menunggu perintah.",
      "Saya merasa yakin bahwa Allah akan menolong selama saya jujur dan berusaha.",
      // Level 10
      "Saya mampu menerima perubahan kebijakan atau dinamika pesantren dengan tenang.",
      "Saya tidak terburu-buru menghakimi, tetapi berusaha memahami situasi dari berbagai sisi.",
      "Saya bisa menyeimbangkan antara keseriusan bekerja dan waktu untuk istirahat.",
      "Saya tidak berlebihan menyesali hasil yang kurang baik, karena percaya Allah menilai niat, bukan sekadar hasil.",
      // Level 11
      "Saya bekerja dengan antusias tanpa menunggu perintah, karena ingin memberi manfaat.",
      "Saya terus belajar hal-hal baru agar bisa menjadi pengasuh yang lebih bijak dan relevan.",
      "Saya menghadapi masalah pengasuhan dengan sikap belajar, bukan keluhan.",
      "Saya berusaha konsisten menjaga niat tulus dalam setiap pelayanan di pesantren.",
      // Level 12
      "Saya mudah memaafkan guru, santri, atau staf yang berbuat salah.",
      "Saya menerima diri saya apa adanya â€” dengan kelebihan dan keterbatasan.",
      "Saya melihat hikmah dari setiap ujian, bahkan yang menyakitkan.",
      "Saya tetap tenang di tengah konflik atau perbedaan pandangan.",
      // Level 13
      "Saya mengambil keputusan dengan berpikir jernih, berdasarkan data dan hikmah.",
      "Saya mencintai ilmu dan terus belajar dari berbagai sumber untuk memperluas wawasan pengasuhan.",
      "Saya sering menemukan tanda kebesaran Allah dalam sistem kehidupan pesantren yang tertata.",
      "Saya menyampaikan pendapat dengan tenang, rasional, dan menghormati perbedaan.",
      // Level 14
      "Saya memperlakukan santri dan guru dengan kasih dan kelembutan hati.",
      "Saya mudah memaafkan tanpa menuntut balasan atau permintaan maaf.",
      "Saya membantu dan melayani dengan niat tulus, bukan demi pujian.",
      "Saya melihat keindahan dan kebaikan Allah dalam setiap aspek kehidupan pesantren.",
      // Level 15
      "Saya merasa bahagia dan ringan dalam mengasuh, tanpa harus menunggu hasil besar.",
      "Saya menerima ujian dan kritik dengan rasa syukur karena itu bagian dari tarbiyah Allah.",
      "Saya membawa suasana cerah dan menenangkan bagi guru dan santri.",
      "Saya menikmati momen sederhana di pesantren â€” kebersamaan, adzan, dan tawa santri â€” dengan rasa syukur.",
      // Level 16
      "Saya tetap tenang menghadapi berbagai persoalan pesantren.",
      "Saya berhenti mengeluh dan lebih banyak berserah diri kepada Allah.",
      "Kehadiran saya membuat orang lain merasa tenteram dan percaya diri.",
      "Saya merasakan ibadah bukan sekadar tugas, tapi perjumpaan yang saya rindukan.",
      // Level 17
      "Saya merasa semua yang terjadi di pesantren adalah bagian dari kehendak Allah yang sempurna.",
      "Saya melihat kehadiran Allah dalam setiap jiwa yang saya temui.",
      "Saya hidup dengan tenang tanpa dorongan ego â€” cukup menjadi saluran kebaikan-Nya.",
      "Saya merasa kehadiran saya membawa kedamaian tanpa perlu banyak bicara."
    ];

    // ===== VARIABEL =====
    const startBtn = document.getElementById("start-btn");
    const introContainer = document.getElementById("intro-container");
    const questionContainer = document.getElementById("question-container");
    const questionText = document.getElementById("question-text");
    const progressText = document.getElementById("progress-text");
    const resultContainer = document.getElementById("result-container");
    const topLevels = document.getElementById("top-levels");
    const restartBtn = document.getElementById("restart-btn");
    let nama = "";
    let current = 0;
    const scores = {};

    // ===== MULAI =====
    startBtn.addEventListener("click", () => {
      nama = document.getElementById("nama").value.trim();
      if (!nama) {
        alert("Masukkan nama terlebih dahulu!");
        return;
      }
      introContainer.classList.add("hidden");
      questionContainer.classList.remove("hidden");
      showQuestion();
    });

    // ===== TAMPILKAN PERTANYAAN =====
    function showQuestion() {
      questionText.textContent = statements[current];
      progressText.textContent = `Pertanyaan ${current + 1} dari ${statements.length}`;
    }

    // ===== PILIHAN JAWAB =====
    document.querySelectorAll(".answer-btn").forEach(btn => {
      btn.addEventListener("click", async () => {
        const score = parseInt(btn.dataset.score);
        const levelIndex = Math.floor(current / 4);
        const level = levels[levelIndex];
        scores[level] = (scores[level] || 0) + score;
        current++;

        if (current < statements.length) {
          showQuestion();
        } else {
          await saveToFirebase();
          showResult();
        }
      });
    });

    // ===== SIMPAN KE FIREBASE =====
    async function saveToFirebase() {
      try {
        await addDoc(collection(db, "asasmen_pengasuh"), {
          nama,
          tanggal: new Date().toLocaleString("id-ID"),
          hasil: scores
        });
        console.log("âœ… Data tersimpan di Firebase");
      } catch (err) {
        console.error("âŒ Gagal menyimpan:", err);
      }
    }

    // ===== TAMPIL HASIL =====
    function showResult() {
      questionContainer.classList.add("hidden");
      resultContainer.classList.remove("hidden");

      const sorted = Object.entries(scores)
        .map(([level, score]) => ({level, score}))
        .sort((a, b) => b.score - a.score)
        .slice(0, 3);

      topLevels.innerHTML = sorted
        .map((l, i) =>
          `<div class="bg-blue-50 border-l-4 border-blue-500 p-3 rounded text-left">
            <span class="font-bold text-blue-700">#${i + 1}</span> ${l.level} â€” <span class="text-gray-600">${l.score} poin</span>
          </div>`
        ).join("");
    }

    restartBtn.addEventListener("click", () => location.reload());
  </script>
</body>
</html>
