<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Asasmen Spiritual Pengasuh</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(to bottom right, #10b981, #0d9488);
      font-family: 'Poppins', sans-serif;
      color: #333;
    }

    .fade-in {
      animation: fadeIn 0.6s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>

<body class="min-h-screen flex flex-col items-center">

  <!-- HEADER -->
  <header class="text-center text-white mt-6">
    <h1 class="text-3xl font-bold drop-shadow-lg">üïäÔ∏è Asasmen Spiritual Pengasuh</h1>
    <p class="text-sm opacity-90 mt-1">Refleksi Naik Level Kesadaran Spiritual</p>
  </header>

  <!-- MAIN CARD -->
  <main class="max-w-3xl w-11/12 mt-6 bg-white/90 backdrop-blur-md p-6 rounded-2xl shadow-lg fade-in">
    
    <!-- FORM NAMA -->
    <div id="intro-container" class="text-center">
      <h2 class="text-xl font-bold text-emerald-700 mb-4">Identitas Pengasuh</h2>
      <input id="nama" type="text" placeholder="Masukkan nama lengkap Anda"
        class="w-full border border-emerald-300 px-4 py-3 rounded-lg mb-6 focus:ring-2 focus:ring-emerald-400 focus:outline-none">
      <button id="start-btn"
        class="bg-emerald-600 text-white px-6 py-2 rounded-lg hover:bg-emerald-700 font-semibold transition">
        üöÄ Mulai Asasmen
      </button>
    </div>

    <!-- ASESMEN -->
    <div id="question-container" class="hidden text-center fade-in">
      <p id="question-text" class="text-lg font-medium mb-6"></p>
      <div class="grid grid-cols-2 gap-4">
        <button class="answer-btn bg-gray-100 hover:bg-emerald-500 hover:text-white rounded-xl py-3 font-semibold transition" data-score="10">Tidak Pernah</button>
        <button class="answer-btn bg-gray-100 hover:bg-emerald-500 hover:text-white rounded-xl py-3 font-semibold transition" data-score="20">Kadang</button>
        <button class="answer-btn bg-gray-100 hover:bg-emerald-500 hover:text-white rounded-xl py-3 font-semibold transition" data-score="40">Sering</button>
        <button class="answer-btn bg-gray-100 hover:bg-emerald-500 hover:text-white rounded-xl py-3 font-semibold transition" data-score="80">Selalu</button>
      </div>
      <div class="mt-6 text-sm text-gray-500" id="progress-text"></div>
    </div>

    <!-- HASIL -->
    <div id="result-container" class="hidden text-center fade-in">
      <h2 class="text-2xl font-bold text-emerald-700 mb-4">üìä Hasil Asasmen</h2>
      <p class="text-gray-700 mb-6">Tiga Level Spiritual yang paling dominan:</p>
      <div id="top-levels" class="space-y-3 text-lg font-semibold"></div>

      <div class="mt-10 flex flex-col gap-3">
        <a href="../riyadhah.html"
           class="bg-gradient-to-r from-emerald-500 to-teal-600 text-white px-6 py-3 rounded-lg font-semibold hover:opacity-90 shadow-md transition">
          üå± Lihat Riyadhah yang Disarankan
        </a>
        <a href="../index.html"
           class="bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-300 transition">
          ‚¨ÖÔ∏è Kembali ke Menu Utama
        </a>
      </div>
    </div>
  </main>

  <footer class="text-xs text-white/80 mt-8 mb-4">¬© 2025 Naik Level ‚Ä¢ Pesantren Fajrul Islam</footer>

  <!-- FIREBASE SDK -->
  <script type="module">
    import { db } from "../assets/firebase-config.js";
    import { collection, addDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

    const levels = [
      "MALU (Shame)", "RASA BERSALAH (Guilt)", "APATI (Apathy)", "BERDUKA (Grief)", "TAKUT (Fear)",
      "KEINGINAN (Desire)", "MARAH (Anger)", "BANGGA (Pride)", "KEBERANIAN (Courage)", "NETRALITAS (Neutrality)",
      "KEMAUAN (Willingness)", "PENERIMAAN (Acceptance)", "AKAL BUDI (Reason)", "CINTA (Love)",
      "SUKACITA (Joy)", "DAMAI (Peace)", "PENCERAHAN (Enlightenment)"
    ];

    saat klik "tampilkan progres", munculkan 4 tab di bawah

tab 1: kehadiran program, sumber databasenya dari kode absensi naqib dan absensi pembelajaran ini, ini kode absensi anqib:

<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>CAHAYA APP ‚Äì Absensi Program Harian</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --primary: #2563eb;
      --primary-dark: #1e40af;
      --border: #e2e8f0;
      --green: #dcfce7;
      --blue: #dbeafe;
      --yellow: #fef9c3;
      --red: #fee2e2;
    }

    body {
      font-family: 'Poppins', Arial, sans-serif;
      background: linear-gradient(135deg, #eef2ff, #e0e7ff);
      color: #1f2937;
      margin: 0;
      padding: 0;
    }

    header {
      background: var(--primary);
      color: white;
      padding: 14px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      border-radius: 0 0 16px 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    header h1 {
      margin: 0;
      font-size: 1rem;
      font-weight: 600;
    }

    header button {
      border: none;
      background: rgba(255,255,255,0.15);
      color: white;
      padding: 6px 12px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.25s;
      font-size: 0.9rem;
    }

    header button:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-1px);
    }

    main {
      background: white;
      margin: 15px auto;
      padding: 16px;
      border-radius: 16px;
      max-width: 900px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    }

    h2 {
      color: var(--primary-dark);
      font-weight: 700;
      margin-top: 0;
      font-size: 1.1rem;
    }

    h3 { margin-top: 18px; color: #1f2937; font-size: 1rem; }

    label {
      display: block;
      font-weight: 600;
      margin-top: 10px;
      color: #374151;
    }

    input, select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 6px;
      border: 1px solid var(--border);
      margin-top: 4px;
      box-sizing: border-box;
      font-size: 0.9rem;
    }

    input:focus, select:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.25);
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 6px;
    }

    .col {
      flex: 1;
      min-width: 180px;
    }

    .info {
      font-size: 0.8rem;
      color: #475569;
    }

    /* === TABEL === */
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
      border-radius: 10px;
      overflow: hidden;
      margin-top: 10px;
    }

    th, td {
      border: 1px solid var(--border);
      padding: 6px;
      text-align: center;
    }

    th {
      background: linear-gradient(90deg, #7ab6ff, #5ea1ff);
      color: white;
      font-weight: 600;
      font-size: 0.9rem;
    }

    td:first-child {
      text-align: left;
      font-weight: 500;
      font-size: 0.9rem;
    }

    /* Warna status */
    tr.status-hadir  { background: var(--green) !important; }
    tr.status-izin   { background: var(--blue) !important; }
    tr.status-sakit  { background: var(--yellow) !important; }
    tr.status-alfa   { background: var(--red) !important; }

    input[type="radio"] {
      accent-color: var(--primary);
      transform: scale(1);
      cursor: pointer;
    }

    /* Tombol */
    button.primary {
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 10px;
      padding: 10px 16px;
      font-weight: 600;
      font-size: 0.95rem;
      margin-top: 16px;
      cursor: pointer;
      width: 100%;
      transition: 0.3s;
    }

    button.primary:hover {
      background: var(--primary-dark);
      transform: translateY(-1px);
    }

    button.secondary {
      background: #6b7280;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 6px 10px;
      font-weight: 600;
      margin-bottom: 8px;
      cursor: pointer;
      font-size: 0.85rem;
    }

    button.secondary:hover { background: #4b5563; }

    /* === RESPONSIVE KHUSUS HP === */
    @media (max-width: 600px) {
      th, td {
        padding: 4px;
        font-size: 0.8rem;
      }

      table {
        table-layout: fixed;
      }

      th:nth-child(1), td:nth-child(1) { width: 40%; }
      th:nth-child(2), td:nth-child(2),
      th:nth-child(3), td:nth-child(3),
      th:nth-child(4), td:nth-child(4),
      th:nth-child(5), td:nth-child(5) { width: 15%; }
    }
  </style>
</head>
<body>

<header>
  <h1>üìã CAHAYA APP ‚Äì Absensi Harian</h1>
  <div>
    <button class="secondary" onclick="goBack()">‚¨ÖÔ∏è Dashboard</button>
    <button onclick="logout()">Keluar</button>
  </div>
</header>

<main>
  <h2 id="naqibTitle">Absensi Program Harian</h2>

  <div class="row">
    <div class="col">
      <label>Tanggal</label>
      <input type="date" id="tanggal">
    </div>
    <div class="col">
      <label>Program</label>
      <select id="program"></select>
      <p class="info">Pastikan program telah sesuai!</p>
    </div>
  </div>

  <h3>Daftar Santri</h3>
  <button type="button" class="secondary" onclick="markAll()">‚úÖ Tandai Semua Hadir</button>

  <table id="tabelSantri">
    <thead>
      <tr>
        <th>Nama Santri</th>
        <th>H</th>
        <th>I</th>
        <th>S</th>
        <th>A</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button type="button" class="primary" onclick="simpan()">üíæ Simpan Absensi</button>
</main>

<!-- === FIREBASE + LOGIKA ABSENSI (VERSI STABIL) === -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB0Ez2a85ZwQLR28U-yHpVmM3o8NMxZoLI",
    authDomain: "absensi-santri-fajrul-islam.firebaseapp.com",
    databaseURL: "https://absensi-santri-fajrul-islam-default-rtdb.firebaseio.com",
    projectId: "absensi-santri-fajrul-islam",
    storageBucket: "absensi-santri-fajrul-islam.appspot.com",
    messagingSenderId: "739928369926",
    appId: "1:739928369926:web:7e95375c3ddba0f584cdd07"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const currentUser = JSON.parse(localStorage.getItem('cahayaCurrentUser') || 'null');

  const programHarian = [
    "Shalat Tahajjud","Shalat Subuh","Joging Pagi","Sarapan","Apel Pagi",
    "Makan Siang","Shalat Zuhur","Qailulah","Shalat Ashar",
    "Piket Kebersihan","Makan Sore","Shalat Maghrib","Shalat Isya","Pengecekan Jurnal"
  ];
  const programPekanan = ["Puasa Kamis","Jemur Kasur"];

  const dataSantri = {
    "Regen":[ "AHMAD MAULANA","JUANDA NUR ILHAM","NAJMIHADI SYAUQII TAMAAM","NIZAM KABISAT","MOHAMMAD IKHSAN HAIRULI","REYFAS RAMADHAN","EZA FEBRI AL FADZRI","HAFIDZ AL ROZI","ANDES AFENDRA","FEBRI GHALIH AL FAROBI","DANANG PRASDITYA SANTOSO","MUHAMMAD RAID MAHRUS","MUHAMMAD DIRGATAMA","CANZA RYANDA HUTASUHUT","FALIZH DAFFA QATRUNNADA","DAFFA AL MUSYARI","RAFI RAMADHAN","WAHYU REYDINATA","AKBAR PRAYOGA","VERY SYACH","MUHAMMAD AL FALAH"],
    "Kamal":[ "ADITYA PUTRA IBRAHIM","AIRLANGGA AZKA ABQORI","AQIELA MARSYAH","BRILLY HANDRIAN","DARREN ATHAYA","DZIKRI MUDHOFFAR","ELLENO QUTHBIE HERMAWAN","FADIL NURHALIM","GABRIEL AL FATIH","HADINATA SAPUTRA","MIKO VAJAR","MUHAMMAD ALMISKY PRATAMA","MUHAMMAD AQIL RIDHO","MUHAMMAD IZAM SAPUTRA","MUHAMMAD SYAKIR HUTABARAT","MUHAMMAD ZIYAD ZHAZHA","MUHAMMAD YASIR AL FAZAR JHIRA","RAFA"],
    "Favian":[ "ANGGA PRATAMA PUTRA","PRAWIRO PUJO TUNGGAL JATI","MUHAMMAD MARPIN","MARFEL SAPUTRA","MELDI NOVRIANSYAH","FAUZAN IBNI JABAR","MUHAMMAD FADHIL BUANA","QHEIZAN ALQIZA ARISDA","REZFY FAKHRYAZKA","MIKA RAHEL YUSUF","KI AGUS MUHAMMAD ABDULLAH SHIDDIQ AGTSALI","ARYA DIFA ALSYA","REYNALDI MALIK IBRAHIM ALFARIDZI","MUHAMMAD XAVI NF","MUHAMMAD FAISAL FIKRIANSYAH","HAFIDZ ALRIZKY","NAUFAL AKBAR ALKHATIRI","FARAZH SAYYID PUTRA KENEGA","SYAHRUL RAMADHAN","LUTHFAN ADZAKI","MUHAMMAD ABIL IRWANSYAH","ALIF SAMUDRA","FAHRIE OKTAVIRANO FITRIS"],
    "Dimas":[ "DIKKI KURNIAWAN","GHOZY FATURRAHMAN","MUHAMMAD THOORIQ","AHMAD RIYADI","ALIF MUHAMMAD YUSUF","BASRI AL HAZIQ ZULFAHMI","MUHAMMAD FAQIH HAFIDZALLAH","ABDULLAH MUKTI HAFIDZALLAH","DEDI SETIADI","FAKHRI AL MUZAKKI","ILHAM MUKMIN AL FARABI","MUHAMMAD ALLAM NUR HUSAIN","MUHAMMAD FIRAAS AL INSYIROH","NABIL NAJMI","SATRIO ABIMAYU","TEGAR HIDAYAT","WAFII FADHLURROHMAN","MUHAMMAD RIJALUL KAMIL","ALVIN HERFIANTINO","ZAHIR ZIBRAN","RADEN AZAA PANCA PUTRA","ZULFAKIH HAERUNNASIHIN"],
    "Shafwan":[ "AHMAD FARHAAN","ANUGRAH PRATAMA","CAHYIS ISZAM","FAHRY AKBAR RAMDHANI","HABIB RAMDHAN","IHZA TRINANDI","ILHAM","M.ARYA MAHDI WAFI EL-FAUZANI","MAHESA AULIA GIFFARI","MUHAMAD YUSUF ARROSIYD","MUHAMMAD USAMAH","NAFIS","RAKA SEPTIAN","RENAL MARTIN","ROHADIN FIRDAUS AL QAUSAR","ROID AFDAL"],
    "Fatimah":[ "NILAM CAHYA","QELZA RAMADHANI ATH THAHIRAH","ASHIFA FITRI RAMADHONI","ADIBA AILA KHANZA","AISYAH NUR KHALIFAH","NYAYU MARLITSA ARDHANI","WILDA","WINDY WINDARI","AISYAH NURUL AULIA","NESSYA RAMADHANY","AMIRAH BALQIS RAHADATUL A'ISYAH","EARLYTA ARSYFA SALSABILA","DAFIA NAFLA SYAKIRA","ANISYA SEPTIANI"],
    "Evita":[ "BILQIS NUR ANISAH","JESSICA PUTRY AYRA","GHENIS ANDIENTIAZ","DINA RUHAYAH","PITRI RAMADANI","GRINNETA NALANI PUTRI","INAYAH NOURAH ANINDYA","SHELENA","FITRAH KIRANA"]
  };

  window.init = function() {
    if (!currentUser || currentUser.role !== 'naqib') {
      alert('Silakan login sebagai Naqib melalui portal utama.');
      window.location.href = '../index.html';
      return;
    }

    document.getElementById('naqibTitle').textContent =
      currentUser.label || `Absensi Program Harian (${currentUser.naqibName || ''})`;

    document.getElementById('tanggal').value =
      new Date().toISOString().split('T')[0];

    isiProgram();
    renderSantri(currentUser.naqibName);
  };

  function isiProgram() {
    const select = document.getElementById('program');
    select.innerHTML = '';

    const group1 = document.createElement('optgroup');
    group1.label = 'Program Harian';
    programHarian.forEach(p => {
      const opt = document.createElement('option');
      opt.value = p;
      opt.textContent = p;
      group1.appendChild(opt);
    });
    select.appendChild(group1);

    const group2 = document.createElement('optgroup');
    group2.label = 'Program Pekanan';
    programPekanan.forEach(p => {
      const opt = document.createElement('option');
      opt.value = p;
      opt.textContent = p;
      group2.appendChild(opt);
    });
    select.appendChild(group2);
  }

  function renderSantri(naqibName) {
    const list = dataSantri[naqibName] || [];
    const tbody = document.querySelector('#tabelSantri tbody');
    tbody.innerHTML = '';

    if (!list.length) {
      tbody.innerHTML = `
        <tr>
          <td colspan="5" style="text-align:center;color:#6b7280">
            Belum ada data santri untuk naqib ini.
          </td>
        </tr>`;
      return;
    }

    list.forEach((nama, i) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${nama}</td>
        <td><input type="radio" name="s_${i}" value="Hadir" checked></td>
        <td><input type="radio" name="s_${i}" value="Izin"></td>
        <td><input type="radio" name="s_${i}" value="Sakit"></td>
        <td><input type="radio" name="s_${i}" value="Alfa"></td>
      `;
      tbody.appendChild(tr);

      // default warna Hadir
      tr.classList.add('status-hadir');
      tr.querySelectorAll('input[type="radio"]').forEach(r => {
        r.addEventListener('change', () => {
          tr.classList.remove('status-hadir','status-izin','status-sakit','status-alfa');
          if (r.value === "Hadir") tr.classList.add('status-hadir');
          if (r.value === "Izin")  tr.classList.add('status-izin');
          if (r.value === "Sakit") tr.classList.add('status-sakit');
          if (r.value === "Alfa")  tr.classList.add('status-alfa');
        });
      });
    });
  }

  window.markAll = function() {
    document.querySelectorAll('#tabelSantri tbody tr').forEach(tr => {
      const radio = tr.querySelector('input[value="Hadir"]');
      if (radio) {
        radio.checked = true;
        tr.classList.remove('status-izin','status-sakit','status-alfa');
        tr.classList.add('status-hadir');
      }
    });
  };

  window.simpan = function() {
    const tanggal = document.getElementById('tanggal').value;
    const program = document.getElementById('program').value;
    if (!tanggal || !program) {
      alert('Mohon pilih tanggal dan program terlebih dahulu.');
      return;
    }

    const hasil = [];
    document.querySelectorAll('#tabelSantri tbody tr').forEach((tr, i) => {
      const nama = tr.children[0].textContent;
      const status = document.querySelector(`input[name="s_${i}"]:checked`)?.value || 'Hadir';
      hasil.push({ nama, status });
    });

    const log = {
      tanggal,
      program,
      naqib: currentUser.naqibName,
      data: hasil,
      waktuSimpan: new Date().toISOString()
    };

    const absensiRef = ref(db, 'cahaya_app/absensi_program_harian');
    push(absensiRef, log)
      .then(() => alert(`‚úÖ Absensi ${program} (${tanggal}) tersimpan ke Firebase.`))
      .catch(err => alert('‚ùå Gagal menyimpan ke Firebase: ' + err.message));
  };

  window.goBack = function() {
    window.location.href = 'dashboard.html';
  };

  window.logout = function() {
    localStorage.removeItem('cahayaCurrentUser');
    window.location.href = '../index.html';
  };

  document.addEventListener('DOMContentLoaded', init);
</script>

</body>
</html>

ini kode absensi pembelajaran:
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>CAHAYA APP - Absensi Kehadiran Pembelajaran</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #eef2ff;
      margin: 0;
      padding: 20px;
      color: #1f2937;
    }
    header {
      background: #2563eb;
      color: white;
      padding: 12px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 10px;
    }
    header h1 { margin: 0; font-size: 1.2rem; }
    main {
      background: white;
      margin-top: 20px;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(15,23,42,0.15);
      max-width: 1000px;
      margin-left: auto;
      margin-right: auto;
    }
    h2 { margin-top: 0; color: #1e3a8a; }
    label { font-weight: bold; display: block; margin-top: 10px; }
    select, input, textarea {
      padding: 8px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      width: 100%;
      box-sizing: border-box;
      margin-top: 4px;
    }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.9rem; }
    th, td { border: 1px solid #e5e7eb; padding: 8px; text-align: center; }
    th { background: #f1f5f9; }
    button {
      background: #2563eb;
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
      font-weight: bold;
      font-size: 0.9rem;
    }
    button:hover { background: #1d4ed8; }
    .btn-secondary { background: #6b7280; }
    .status-btn {
      padding: 4px 10px;
      border-radius: 5px;
      border: 1px solid #cbd5e1;
      cursor: pointer;
      background: #f8fafc;
    }
    .status-btn.active {
      background: #2563eb;
      color: white;
      border-color: #2563eb;
    }
  </style>
</head>
<body>

<header>
  <h1>CAHAYA APP ‚Äì Absensi Kehadiran Pembelajaran</h1>
  <div>
    <button class="btn-secondary" onclick="goBack()">‚¨ÖÔ∏è Kembali</button>
    <button onclick="logout()">Keluar</button>
  </div>
</header>

<main>
  <h2>Absensi Kehadiran Pembelajaran</h2>

  <div style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:12px">
    <div style="flex:1;min-width:180px">
      <label>Tanggal</label>
      <input type="date" id="kbmTanggal">
    </div>
    <div style="flex:1;min-width:200px">
      <label>Jenis Kelas</label>
      <select id="kbmJenisKelas" onchange="updatePilihan()">
        <option value="">-- Pilih Jenis Kelas --</option>
        <option value="keilmuan">Keilmuan Islam & Umum</option>
        <option value="bahasa">Bahasa Internasional</option>
        <option value="tahfiz">Tahsin & Tahfiz Al-Qur'an</option>
      </select>
    </div>
    <div style="flex:1;min-width:200px" id="opsiKhusus"></div>
    <div style="flex:1;min-width:200px">
      <label>Mata Pelajaran</label>
      <select id="kbmMapel">
        <option value="">-- Pilih Mapel --</option>
      </select>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th>No</th>
        <th>Nama Santri</th>
        <th>Hadir</th>
        <th>Izin</th>
        <th>Sakit</th>
        <th>Alfa</th>
      </tr>
    </thead>
    <tbody id="kbmBody">
      <tr><td colspan="6" style="text-align:center;color:#6b7280">Pilih jenis kelas terlebih dahulu.</td></tr>
    </tbody>
  </table>

  <label style="margin-top:20px">Ringkasan Materi / Catatan KBM:</label>
  <textarea id="kbmCatatan" rows="3" placeholder="Tuliskan materi yang diajarkan, aktivitas pembelajaran, refleksi, dll..."></textarea>

  <button onclick="simpanKehadiran()">üíæ Simpan Kehadiran</button>
</main>

<script src="dataSantri.js"></script>

<!-- === FIREBASE MODULE === -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB0Ez2a85ZwQLR28U-yHpVmM3o8NMxZoLI",
    authDomain: "absensi-santri-fajrul-islam.firebaseapp.com",
    databaseURL: "https://absensi-santri-fajrul-islam-default-rtdb.firebaseio.com",
    projectId: "absensi-santri-fajrul-islam",
    storageBucket: "absensi-santri-fajrul-islam.appspot.com",
    messagingSenderId: "739928369926",
    appId: "1:739928369926:web:7e95375c3ddba0f584cdd07"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const user = JSON.parse(localStorage.getItem('cahayaCurrentUser') || 'null');

  // --- Inisialisasi halaman ---
  window.init = function() {
    if (!user || user.role !== 'guru') {
      alert('Silakan login sebagai Guru terlebih dahulu.');
      window.location.href = '../index.html';
      return;
    }
    document.getElementById('kbmTanggal').value = new Date().toISOString().split('T')[0];
  };

  // --- Update Pilihan Kelas dan Mapel ---
  window.updatePilihan = function() {
    const jenis = document.getElementById('kbmJenisKelas').value;
    const container = document.getElementById('opsiKhusus');
    const tbody = document.getElementById('kbmBody');
    const mapelSelect = document.getElementById('kbmMapel');

    container.innerHTML = '';
    tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:#6b7280">Menunggu pilihan detail kelas...</td></tr>';
    mapelSelect.innerHTML = '<option value="">-- Pilih Mapel --</option>';

    if (!jenis) return;

    let jenisKey = '';
    let mapelList = [];
    if (jenis === 'keilmuan') {
      jenisKey = 'Keilmuan Islam & Umum';
      mapelList = ['Fiqih','Akidah','Adab','Nahwu','Sirah','Sharaf','Balaghah','Kewirausahaan','Metode Pengajaran'];
    } else if (jenis === 'bahasa') {
      jenisKey = 'Bahasa Internasional';
      mapelList = ['Bahasa Arab','Bahasa Inggris'];
    } else if (jenis === 'tahfiz') {
      jenisKey = 'Tahsin & Tahfiz Al-Qur\'an';
      mapelList = ['Tahsin','Tahfiz'];
    }

    mapelList.forEach(m => {
      const opt = document.createElement('option');
      opt.value = m;
      opt.textContent = m;
      mapelSelect.appendChild(opt);
    });

    const kategori = dataSantri[jenisKey];
    if (!kategori) return;

    if (jenis === 'keilmuan' || jenis === 'bahasa') {
      container.innerHTML = `
        <label>${jenis === 'keilmuan' ? 'Kelas' : 'Kelompok'}</label>
        <select id="subPilihan" onchange="tampilkanSantri('${jenis}')">
          <option value="">-- Pilih ${jenis === 'keilmuan' ? 'Kelas' : 'Kelompok'} --</option>
          ${Object.keys(kategori).map(k => `<option value="${k}">${k}</option>`).join('')}
        </select>`;
    } else if (jenis === 'tahfiz') {
      container.innerHTML = `
        <label>Program & Kelompok</label>
        <div style="display:flex;gap:8px">
          <select id="programTahfiz">
            <option value="Tahsin">Tahsin</option>
            <option value="Tahfiz">Tahfiz</option>
          </select>
          <select id="subPilihan" onchange="tampilkanSantri('${jenis}')">
            <option value="">-- Pilih Kelompok --</option>
            ${Object.keys(kategori).map(k => `<option value="${k}">${k}</option>`).join('')}
          </select>
        </div>`;
    }
  };

  // --- Tampilkan Santri ---
  window.tampilkanSantri = function(jenis) {
    const tbody = document.getElementById('kbmBody');
    tbody.innerHTML = '';
    const jenisKey = jenis === 'keilmuan' ? 'Keilmuan Islam & Umum' :
                     jenis === 'bahasa' ? 'Bahasa Internasional' :
                     'Tahsin & Tahfiz Al-Qur\'an';
    const kategori = dataSantri[jenisKey];
    if (!kategori) return;

    const sub = document.getElementById('subPilihan').value;
    let list = [];

    if (jenis === 'tahfiz') {
      const program = document.getElementById('programTahfiz').value;
      if (kategori[`${program} ${sub}`]) list = kategori[`${program} ${sub}`];
      else if (kategori[sub]) list = kategori[sub];
    } else {
      list = kategori[sub] || [];
    }

    if (list.length === 0) {
      tbody.innerHTML = `<tr><td colspan="6" style="text-align:center;color:#6b7280">Belum ada data santri untuk pilihan ini.</td></tr>`;
      return;
    }

    list.forEach((nama, i) => {
      const tr = document.createElement('tr');
      tr.dataset.nama = nama;
      tr.dataset.status = 'Hadir';
      tr.innerHTML = `
        <td>${i + 1}</td>
        <td style="text-align:left">${nama}</td>
        <td><button class="status-btn active" onclick="setStatus(this,'Hadir')">‚úîÔ∏è</button></td>
        <td><button class="status-btn" onclick="setStatus(this,'Izin')">I</button></td>
        <td><button class="status-btn" onclick="setStatus(this,'Sakit')">S</button></td>
        <td><button class="status-btn" onclick="setStatus(this,'Alfa')">A</button></td>`;
      tbody.appendChild(tr);
    });
  };

  // --- Ubah status hadir/izin/sakit/alfa ---
  window.setStatus = function(btn, status) {
    const row = btn.closest('tr');
    row.dataset.status = status;
    row.querySelectorAll('.status-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
  };

  // --- Simpan ke Firebase ---
  window.simpanKehadiran = function() {
    const tanggal = document.getElementById('kbmTanggal').value;
    const jenis   = document.getElementById('kbmJenisKelas').value;
    const mapel   = document.getElementById('kbmMapel').value;
    const sub     = document.getElementById('subPilihan')?.value || '';
    const program = document.getElementById('programTahfiz')?.value || '';
    const catatan = document.getElementById('kbmCatatan').value.trim();

    if (!tanggal || !jenis || !sub || !mapel) {
      alert('Lengkapi semua data kehadiran.');
      return;
    }

    const rows = document.querySelectorAll('#kbmBody tr');
    const data = [];
    rows.forEach(r => data.push({ nama: r.dataset.nama, status: r.dataset.status }));

    const log = {
      tanggal,
      jenis,
      sub,
      mapel,
      program,
      catatan,
      guru: user.username,
      data,
      waktuSimpan: new Date().toISOString()
    };

    const absensiRef = ref(db, 'cahaya_app/absensi_pembelajaran');
    push(absensiRef, log)
      .then(() => alert('‚úÖ Kehadiran pembelajaran tersimpan ke Firebase!'))
      .catch(err => {
        console.error(err);
        alert('‚ùå Gagal menyimpan ke Firebase: ' + err.message);
      });
  };

  window.goBack = function() { window.location.href = 'fitur.html'; };
  window.logout = function() { localStorage.removeItem('cahayaCurrentUser'); window.location.href = '../index.html'; };
  document.addEventListener('DOMContentLoaded', init);
</script>

</body>
</html>

tab 2: setoran tahfiz
kodenya dari: <!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>CAHAYA APP - Input Setoran Tahfiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: "Poppins", Arial, sans-serif;
      background: linear-gradient(135deg, #eef2ff, #dbeafe);
      margin: 0;
      padding: 16px;
      color: #1f2937;
    }

    header {
      background: #2563eb;
      color: white;
      padding: 14px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      border-radius: 12px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.15);
    }
    header h1 { margin: 0; font-size: 1.2rem; font-weight: 600; }

    main {
      background: white;
      margin-top: 20px;
      border-radius: 14px;
      padding: 20px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
      max-width: 1100px;
      margin-left: auto;
      margin-right: auto;
    }

    h2 {
      margin-top: 0;
      color: #1e3a8a;
      font-size: 1.3rem;
      margin-bottom: 16px;
    }

    label {
      font-weight: bold;
      display: block;
      margin-top: 8px;
      color: #1f2937;
    }

    select, input, textarea {
      padding: 9px;
      border: 1px solid #cbd5e1;
      border-radius: 8px;
      width: 100%;
      box-sizing: border-box;
      font-size: 0.95rem;
      margin-top: 4px;
    }

    button {
      background: #2563eb;
      color: white;
      border: none;
      padding: 10px 18px;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 14px;
      font-weight: bold;
      font-size: 0.95rem;
      transition: 0.2s;
    }

    button:hover { background: #1e40af; transform: translateY(-1px); }
    .btn-secondary { background: #6b7280; }
    .btn-secondary:hover { background: #4b5563; }

    /* ==== WRAPPER TABLE ==== */
    .table-wrapper {
      overflow-x: auto;
      margin-top: 14px;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 800px;
      font-size: 0.9rem;
    }

    th, td {
      border: 1px solid #e5e7eb;
      padding: 8px;
      text-align: center;
      white-space: nowrap;
    }

    th {
      background: #f1f5f9;
      color: #1e293b;
      font-weight: 600;
    }

    tr:nth-child(even) { background: #f9fafb; }

    input[type="text"], input[type="number"] {
      padding: 6px;
      border-radius: 6px;
      border: 1px solid #cbd5e1;
      font-size: 0.85rem;
      width: 100%;
    }

    /* ==== RESPONSIVE ==== */
    @media (max-width: 700px) {
      header { flex-direction: column; align-items: flex-start; gap: 8px; }
      h2 { font-size: 1.1rem; }
      button { width: 100%; font-size: 1rem; padding: 12px; }
      select, input { font-size: 1rem; }
      .table-wrapper { border-radius: 6px; }
    }
  </style>
</head>

<body>

<header>
  <h1>CAHAYA APP ‚Äì Input Setoran Tahfiz</h1>
  <div style="display:flex;gap:8px;flex-wrap:wrap;">
    <button class="btn-secondary" onclick="goBack()">‚¨ÖÔ∏è Kembali</button>
    <button onclick="logout()">Keluar</button>
  </div>
</header>

<main>
  <h2>üìñ Input Setoran Tahfiz Santri</h2>

  <div style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:12px">
    <div style="flex:1;min-width:180px">
      <label>Tanggal Setoran</label>
      <input type="date" id="tfzTanggal">
    </div>
    <div style="flex:1;min-width:200px">
      <label>Program</label>
      <select id="tfzProgram" onchange="updateKelompok()">
        <option value="">-- Pilih Program --</option>
        <option value="Tahsin">Tahsin</option>
        <option value="Tahfiz">Tahfiz</option>
      </select>
    </div>
    <div style="flex:1;min-width:200px">
      <label>Kelompok</label>
      <select id="tfzKelompok" onchange="tampilkanSantri()">
        <option value="">-- Pilih Kelompok --</option>
      </select>
    </div>
  </div>

  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>No</th>
          <th>Nama Santri</th>
          <th>Setoran Hari Ini</th>
          <th>Jumlah Ayat</th>
          <th>Kesalahan</th>
          <th>Nilai</th>
          <th>Keterangan</th>
        </tr>
      </thead>
      <tbody id="tfzBody">
        <tr>
          <td colspan="7" style="text-align:center;color:#6b7280">
            Pilih program & kelompok untuk menampilkan daftar santri.
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <button onclick="simpanSetoran()">üíæ Simpan Setoran</button>
</main>

<script src="dataSantri.js"></script>

<!-- === FIREBASE MODULE === -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB0Ez2a85ZwQLR28U-yHpVmM3o8NMxZoLI",
    authDomain: "absensi-santri-fajrul-islam.firebaseapp.com",
    databaseURL: "https://absensi-santri-fajrul-islam-default-rtdb.firebaseio.com",
    projectId: "absensi-santri-fajrul-islam",
    storageBucket: "absensi-santri-fajrul-islam.appspot.com",
    messagingSenderId: "739928369926",
    appId: "1:739928369926:web:7e95375c3ddba0f584cdd07"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const user = JSON.parse(localStorage.getItem('cahayaCurrentUser') || 'null');

  window.init = function() {
    if (!user || user.role !== 'guru') {
      alert('Silakan login sebagai Guru terlebih dahulu.');
      window.location.href = '../index.html';
      return;
    }
    document.getElementById('tfzTanggal').value = new Date().toISOString().split('T')[0];
  };

  window.updateKelompok = function() {
    const program = document.getElementById('tfzProgram').value;
    const kelompokSelect = document.getElementById('tfzKelompok');
    const tbody = document.getElementById('tfzBody');
    kelompokSelect.innerHTML = '<option value="">-- Pilih Kelompok --</option>';
    tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:#6b7280">Silakan pilih kelompok...</td></tr>';

    if (!program) return;
    const kategori = dataSantri["Tahsin & Tahfiz Al-Qur'an"];
    if (!kategori) return;

    const kelompokList = Object.keys(kategori)
      .filter(k => k.startsWith(program + ' '))
      .map(k => k.replace(program + ' ', ''));

    if (kelompokList.length === 0) {
      const opt = document.createElement('option');
      opt.textContent = 'Belum ada kelompok';
      kelompokSelect.appendChild(opt);
      return;
    }

    kelompokList.forEach(k => {
      const opt = document.createElement('option');
      opt.textContent = k;
      kelompokSelect.appendChild(opt);
    });
  };

  window.tampilkanSantri = function() {
    const program = document.getElementById('tfzProgram').value;
    const kelompok = document.getElementById('tfzKelompok').value;
    const kategori = dataSantri["Tahsin & Tahfiz Al-Qur'an"];
    const key = `${program} ${kelompok}`;
    const list = kategori[key] || [];
    const tbody = document.getElementById('tfzBody');
    tbody.innerHTML = '';

    if (!program || !kelompok) {
      tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:#6b7280">Lengkapi program & kelompok.</td></tr>';
      return;
    }

    if (list.length === 0) {
      tbody.innerHTML = `<tr><td colspan="7" style="text-align:center;color:#6b7280">Tidak ada data santri untuk pilihan ini.</td></tr>`;
      return;
    }

    list.forEach((nama, i) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${i + 1}</td>
        <td style="text-align:left">${nama}</td>
        <td><input type="text" placeholder="QS Al-Baqarah 1-10" /></td>
        <td><input type="number" min="1" max="286" value="0" style="max-width:80px" /></td>
        <td><input type="number" min="0" value="0" style="max-width:70px" oninput="hitungNilai(this)" /></td>
        <td><input type="text" readonly placeholder="Predikat otomatis" /></td>
        <td><input type="text" placeholder="Keterangan..." /></td>
      `;
      tbody.appendChild(tr);
    });
  };

  window.hitungNilai = function(inputKesalahan) {
    const row = inputKesalahan.closest('tr');
    const nilaiInput = row.cells[5].querySelector('input');
    let salah = parseInt(inputKesalahan.value, 10);
    if (isNaN(salah) || salah < 0) salah = 0;

    let predikat = '';
    if (salah === 0) predikat = 'Mumtaz';
    else if (salah <= 3) predikat = 'Jayyid Jiddan';
    else if (salah <= 6) predikat = 'Jayyid';
    else if (salah <= 9) predikat = 'Maqbul';
    else predikat = 'Perlu Bimbingan';

    nilaiInput.value = predikat;
  };

  window.simpanSetoran = function() {
    const tanggal = document.getElementById('tfzTanggal').value;
    const program = document.getElementById('tfzProgram').value;
    const kelompok = document.getElementById('tfzKelompok').value;

    if (!tanggal || !program || !kelompok) {
      alert('Lengkapi semua pilihan terlebih dahulu.');
      return;
    }

    const rows = document.querySelectorAll('#tfzBody tr');
    const data = [];

    rows.forEach(row => {
      const nama = row.cells[1].innerText;
      const setoran = row.cells[2].querySelector('input').value.trim();
      const ayat = row.cells[3].querySelector('input').value;
      const kesalahan = row.cells[4].querySelector('input').value;
      const nilai = row.cells[5].querySelector('input').value.trim();
      const ket = row.cells[6].querySelector('input').value.trim();

      if (setoran !== '') {
        data.push({ nama, setoran, ayat, kesalahan, nilai, ket });
      }
    });

    if (data.length === 0) {
      alert('Belum ada data setoran yang diisi.');
      return;
    }

    const log = {
      tanggal,
      program,
      kelompok,
      guru: user.username,
      data,
      waktuSimpan: new Date().toISOString()
    };

    const setoranRef = ref(db, 'cahaya_app/setoran_tahfiz');
    push(setoranRef, log)
      .then(() => {
        alert('‚úÖ Data setoran tahfiz tersimpan ke Firebase!');
      })
      .catch(err => {
        console.error(err);
        alert('‚ùå Gagal menyimpan ke Firebase: ' + err.message);
      });
  };

  window.goBack = function() { window.location.href = 'fitur.html'; };
  window.logout = function() { localStorage.removeItem('cahayaCurrentUser'); window.location.href = '../index.html'; };
  document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>

tab ke 3: pelaggaran
kodenya:
const statements = [
  // Level 1 ‚Äî MALU (Shame)
  "Dalam 1 bulan terakhir, saya merasa tidak layak membimbing orang lain karena merasa diri penuh kekurangan.",
  "Dalam 1 bulan terakhir, saya memilih menarik diri dari peran kepengasuhan karena takut dinilai atau disalahpahami.",
  "Dalam 1 bulan terakhir, saya merasa Allah mungkin sudah tidak ridha atas pengabdian saya di pesantren.",
  "Dalam 1 bulan terakhir, saya merasa kehadiran saya justru membebani orang lain, bukan membawa manfaat.",

  // Level 2 ‚Äî RASA BERSALAH (Guilt)
  "Dalam 1 bulan terakhir, saya sering teringat kesalahan masa lalu dan merasa belum pantas diampuni.",
  "Dalam 1 bulan terakhir, saya menolak ketenangan batin karena merasa belum menebus dosa atau kelalaian saya sebagai pengasuh.",
  "Dalam 1 bulan terakhir, saya berbuat baik dengan keras terhadap diri sendiri, bukan karena cinta, tapi karena ingin menebus kesalahan.",
  "Dalam 1 bulan terakhir, saya sulit memaafkan diri sendiri meski saya yakin Allah Maha Pengampun.",

  // Level 3 ‚Äî APATI (Apathy)
  "Dalam 1 bulan terakhir, saya menjalankan peran pengasuhan secara mekanis, tanpa semangat dan tanpa makna.",
  "Dalam 1 bulan terakhir, saya merasa perubahan di pesantren percuma, seolah tidak ada yang bisa diperbaiki.",
  "Dalam 1 bulan terakhir, saya kehilangan arah dan makna dari pengabdian saya.",
  "Dalam 1 bulan terakhir, saya merasa mati rasa terhadap santri dan rekan kerja, seolah semua tidak lagi berarti.",

  // Level 4 ‚Äî BERDUKA (Grief)
  "Dalam 1 bulan terakhir, saya sering mengenang masa lalu saat suasana pesantren terasa lebih baik.",
  "Dalam 1 bulan terakhir, saya merasa kesedihan atas perubahan di pesantren sulit saya lepaskan.",
  "Dalam 1 bulan terakhir, saya merasa kehilangan semangat lama dan sulit menemukan kembali gairah membina santri.",
  "Dalam 1 bulan terakhir, saya sering menyesali keputusan atau sikap saya di masa lalu.",

  // Level 5 ‚Äî TAKUT (Fear)
  "Dalam 1 bulan terakhir, saya menjalankan peran dengan cemas ‚Äî takut salah, takut dikritik, atau takut mengecewakan pimpinan.",
  "Dalam 1 bulan terakhir, saya menghindari menegur atau mengambil keputusan karena takut menimbulkan konflik.",
  "Dalam 1 bulan terakhir, saya banyak memikirkan hal-hal buruk yang mungkin terjadi pada diri atau pesantren.",
  "Dalam 1 bulan terakhir, saya menjaga jarak dengan santri atau guru karena takut terluka secara emosional.",

  // Level 6 ‚Äî KEINGINAN (Desire)
  "Dalam 1 bulan terakhir, saya merasa gelisah bila program atau gagasan saya tidak dihargai.",
  "Dalam 1 bulan terakhir, saya membandingkan diri dengan pengasuh lain dan merasa iri dengan pencapaian mereka.",
  "Dalam 1 bulan terakhir, saya merasa terus mengejar sesuatu tapi tidak pernah benar-benar puas.",
  "Dalam 1 bulan terakhir, saya merasa semangat saya muncul hanya bila ada pujian, penghargaan, atau perhatian dari orang lain.",

  // Level 7 ‚Äî MARAH (Anger)
  "Dalam 1 bulan terakhir, saya mudah tersinggung terhadap ucapan, perilaku, atau keputusan orang lain di pesantren.",
  "Dalam 1 bulan terakhir, suasana di sekitar saya sering menjadi tegang karena sikap saya yang keras atau reaktif.",
  "Dalam 1 bulan terakhir, saya menyimpan kekecewaan pada orang yang tidak sejalan dengan saya.",
  "Dalam 1 bulan terakhir, saya sering menyalahkan keadaan atau orang lain atas hasil yang tidak sesuai harapan.",

  // Level 8 ‚Äî BANGGA (Pride)
  "Dalam 1 bulan terakhir, saya sulit menerima masukan dari pengurus atau rekan sejawat yang lebih muda.",
  "Dalam 1 bulan terakhir, saya berusaha terlihat kuat dan sempurna agar tidak kehilangan wibawa.",
  "Dalam 1 bulan terakhir, saya menilai orang lain dari penampilan dan hasil lahiriah lebih dari niat dan perjuangannya.",
  "Dalam 1 bulan terakhir, saya cenderung mencari pembenaran diri saat salah, agar tetap terlihat benar di hadapan orang lain.",

  // Level 9 ‚Äî KEBERANIAN (Courage)
  "Dalam 1 bulan terakhir, saya berani mengakui kesalahan di hadapan santri atau rekan kerja tanpa takut kehilangan wibawa.",
  "Dalam 1 bulan terakhir, saya memandang setiap masalah di pesantren sebagai tantangan yang bisa memperkuat tim.",
  "Dalam 1 bulan terakhir, saya mengambil langkah inisiatif untuk memperbaiki keadaan tanpa menunggu perintah.",
  "Dalam 1 bulan terakhir, saya merasa yakin bahwa Allah akan menolong selama saya jujur dan berusaha.",

  // Level 10 ‚Äî NETRALITAS (Neutrality)
  "Dalam 1 bulan terakhir, saya mampu menerima perubahan kebijakan atau dinamika pesantren dengan tenang.",
  "Dalam 1 bulan terakhir, saya tidak terburu-buru menghakimi, tetapi berusaha memahami situasi dari berbagai sisi.",
  "Dalam 1 bulan terakhir, saya bisa menyeimbangkan antara keseriusan bekerja dan waktu untuk istirahat.",
  "Dalam 1 bulan terakhir, saya tidak berlebihan menyesali hasil yang kurang baik, karena percaya Allah menilai niat, bukan sekadar hasil.",

  // Level 11 ‚Äî KEMAUAN (Willingness)
  "Dalam 1 bulan terakhir, saya bekerja dengan antusias tanpa menunggu perintah, karena ingin memberi manfaat.",
  "Dalam 1 bulan terakhir, saya terus belajar hal-hal baru agar bisa menjadi pengasuh yang lebih bijak dan relevan.",
  "Dalam 1 bulan terakhir, saya menghadapi masalah pengasuhan dengan sikap belajar, bukan keluhan.",
  "Dalam 1 bulan terakhir, saya berusaha konsisten menjaga niat tulus dalam setiap pelayanan di pesantren.",

  // Level 12 ‚Äî PENERIMAAN (Acceptance)
  "Dalam 1 bulan terakhir, saya mudah memaafkan guru, santri, atau staf yang berbuat salah.",
  "Dalam 1 bulan terakhir, saya menerima diri saya apa adanya ‚Äî dengan kelebihan dan keterbatasan.",
  "Dalam 1 bulan terakhir, saya melihat hikmah dari setiap ujian, bahkan yang menyakitkan.",
  "Dalam 1 bulan terakhir, saya tetap tenang di tengah konflik atau perbedaan pandangan.",

  // Level 13 ‚Äî AKAL BUDI (Reason)
  "Dalam 1 bulan terakhir, saya mengambil keputusan dengan berpikir jernih, berdasarkan data dan hikmah.",
  "Dalam 1 bulan terakhir, saya mencintai ilmu dan terus belajar dari berbagai sumber untuk memperluas wawasan pengasuhan.",
  "Dalam 1 bulan terakhir, saya sering menemukan tanda kebesaran Allah dalam sistem kehidupan pesantren yang tertata.",
  "Dalam 1 bulan terakhir, saya menyampaikan pendapat dengan tenang, rasional, dan menghormati perbedaan.",

  // Level 14 ‚Äî CINTA (Love)
  "Dalam 1 bulan terakhir, saya memperlakukan santri dan guru dengan kasih dan kelembutan hati.",
  "Dalam 1 bulan terakhir, saya mudah memaafkan tanpa menuntut balasan atau permintaan maaf.",
  "Dalam 1 bulan terakhir, saya membantu dan melayani dengan niat tulus, bukan demi pujian.",
  "Dalam 1 bulan terakhir, saya melihat keindahan dan kebaikan Allah dalam setiap aspek kehidupan pesantren.",

  // Level 15 ‚Äî SUKACITA (Joy)
  "Dalam 1 bulan terakhir, saya merasa bahagia dan ringan dalam mengasuh, tanpa harus menunggu hasil besar.",
  "Dalam 1 bulan terakhir, saya menerima ujian dan kritik dengan rasa syukur karena itu bagian dari tarbiyah Allah.",
  "Dalam 1 bulan terakhir, saya membawa suasana cerah dan menenangkan bagi guru dan santri.",
  "Dalam 1 bulan terakhir, saya menikmati momen sederhana di pesantren ‚Äî kebersamaan, adzan, dan tawa santri ‚Äî dengan rasa syukur.",

  // Level 16 ‚Äî DAMAI (Peace)
  "Dalam 1 bulan terakhir, saya tetap tenang menghadapi berbagai persoalan pesantren.",
  "Dalam 1 bulan terakhir, saya berhenti mengeluh dan lebih banyak berserah diri kepada Allah.",
  "Dalam 1 bulan terakhir, kehadiran saya membuat orang lain merasa tenteram dan percaya diri.",
  "Dalam 1 bulan terakhir, saya merasakan ibadah bukan sekadar tugas, tapi perjumpaan yang saya rindukan.",

  // Level 17 ‚Äî PENCERAHAN (Enlightenment)
  "Dalam 1 bulan terakhir, saya merasa semua yang terjadi di pesantren adalah bagian dari kehendak Allah yang sempurna.",
  "Dalam 1 bulan terakhir, saya melihat kehadiran Allah dalam setiap jiwa yang saya temui.",
  "Dalam 1 bulan terakhir, saya hidup dengan tenang tanpa dorongan ego ‚Äî cukup menjadi saluran kebaikan-Nya.",
  "Dalam 1 bulan terakhir, saya merasa kehadiran saya membawa kedamaian tanpa perlu banyak bicara."
];

    const startBtn = document.getElementById("start-btn");
    const introContainer = document.getElementById("intro-container");
    const questionContainer = document.getElementById("question-container");
    const questionText = document.getElementById("question-text");
    const progressText = document.getElementById("progress-text");
    const resultContainer = document.getElementById("result-container");
    const topLevels = document.getElementById("top-levels");

    let nama = "";
    let current = 0;
    const scores = {};

    startBtn.addEventListener("click", () => {
      nama = document.getElementById("nama").value.trim();
      if (!nama) {
        alert("Masukkan nama terlebih dahulu!");
        return;
      }
      introContainer.classList.add("hidden");
      questionContainer.classList.remove("hidden");
      showQuestion();
    });

    function showQuestion() {
      questionText.textContent = statements[current];
      progressText.textContent = `Pertanyaan ${current + 1} dari ${statements.length}`;
    }

    document.querySelectorAll(".answer-btn").forEach(btn => {
      btn.addEventListener("click", async () => {
        const score = parseInt(btn.dataset.score);
        const levelIndex = Math.floor(current / 4);
        const level = levels[levelIndex];
        scores[level] = (scores[level] || 0) + score;
        current++;

        if (current < statements.length) {
          showQuestion();
        } else {
          await saveToFirebase();
          showResult();
        }
      });
    });

    async function saveToFirebase() {
      try {
        await addDoc(collection(db, "asasmen_pengasuh"), {
          nama,
          tanggal: new Date().toLocaleString("id-ID"),
          hasil: scores
        });
        console.log("‚úÖ Data tersimpan di Firestore");
      } catch (err) {
        console.error("‚ùå Gagal menyimpan:", err);
        alert("Terjadi kesalahan saat menyimpan data.");
      }
    }

    function showResult() {
      questionContainer.classList.add("hidden");
      resultContainer.classList.remove("hidden");

      const sorted = Object.entries(scores)
        .map(([level, score]) => ({ level, score }))
        .sort((a, b) => b.score - a.score)
        .slice(0, 3);

      topLevels.innerHTML = sorted
        .map((l, i) =>
          `<div class="bg-gradient-to-r from-emerald-50 to-teal-50 border-l-4 border-emerald-500 p-3 rounded text-left shadow-sm">
            <span class="font-bold text-emerald-700">#${i + 1}</span> 
            ${l.level} ‚Äî <span class="text-gray-600">${l.score} poin</span>
          </div>`
        ).join("");
    }
  </script>
</body>
</html>
